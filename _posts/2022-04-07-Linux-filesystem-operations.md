---
layout: post
title:  "Операции с файловой системой в Linux"
categories: [ Системное администрирование ]
tags: [ Linux, CentOS, LVM, How To ]
image: assets/images/linux-filesystem-operations/0.jpg
author: Mikhail
---
***Статья из серии `How To...`. В этой я собрал способы выполнить самые частые операции с файловой системой в Linux, в частности в `CentOS`. Статья может использоваться как справочник и будет дополняться. Добавляйте в закладки.***

Заходя в Windows, системный администратор может наглядно наблюдать подключенные дисковые устройства, видеть их тип, размер, свободное пространство, выполнять операции форматирования, расширения диска и т.п.. В Linux не всё так очевидно, приходится запоминать множество команд. Эта статья даёт ответы на следующие вопросы:

* [Сколько дисков в системе, как их увидеть?](#lsdev)
* [Как "разбиты" диски, сколько партиций, их тип и размер?](#fdisk)
* [Сколько свободного места на дисках?](#df)
* [Как новый жесткий диск сделать доступным в системе?](#newdisk)
* [Как создать новый раздел?](#fdisk)
* [Как отформатировать раздел?](#mkfs)
* [Как смонтировать раздел?](#mount)
<!-- * [Как расширить пространство после увеличения размера жёсткого диска?] -->
* [Как разбить файловую систему во время установки ОС?](https://danshin.ms/LVM-quick-start/)

<a name="lsdev"></a>

# Сколько дисков в системе, как их увидеть?

Как известно, в *Linux всё есть файл*. И память, и диски - всё. Поэтому самый простой способ посмотреть устройства - это вывести содержимое каталога, где содержатся устройства. Устройства "живут" в `/dev`, а блочные, дисковые устройства называются sda, sdb и т.д., если они подключены через SCSI и hda, hdb и т.д., если через IDE. Сейчас, в век виртуализации, конечно, чаще всего можно встретить только SCSI устройства. Следующая команда выведет список всех дисков в системе:

```bash
ls -l /dev/sd*
```
```
`ls` - вывести содержимое каталога
`-l` - вывести списком
`/dev/sd*` - вывести содержимое каталога /dev, начинающееся на `sd`
```

![assets/images/linux-filesystem-operations/1.png](/assets/images/linux-filesystem-operations/1.png)

<a name="fdisk"></a>

# Как "разбиты" диски, сколько партиций, их тип и размер?

Есть несколько способов увидеть эту информацию. Не прибегая ни к каким утилитам, что может быть полезно в системах с минимальным набором установленных пакетов, можно воспользоваться способом посмотреть содержимое файла `/proc/partitions`. Этот файл содержит информацию о распределённых блоках партиций. Посмотреть содержимое можно командой `cat`:

```bash
cat /proc/partitions
```

Пример этого вывода выглядит следующим образом:

![assets/images/linux-filesystem-operations/2.png](/assets/images/linux-filesystem-operations/2.png)

Больше информации о `Proc File System` (содержимом каталога /proc) можно узнать в [документации по RedHat](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/s1-proc-topfiles).

Есть ещё одна утилита `fdisk`. Следующей командой, можно увидеть информацию о всех дисках и их размерах:

```bash
sudo fdisk -l
```

Более компактные сведения можно получить утилитой `parted` выполнив следующую команду:

```bash
sudo parted -l
```

![assets/images/linux-filesystem-operations/4.png](/assets/images/linux-filesystem-operations/4.png)


<a name="df"></a>

# Сколько свободного места на дисках?

Проще всего посмотреть свободное место на диске, воспользоваться утилитой `df`. Она выведет на экран все смонтированные файловые системы и дополнительную информацию, в частности размер. Удобнее всего воспользоваться следующей командой:

```bash
df -hT
```

```text
`df` - вывести информацию о смонтированных разделах
`-h` - вывести размер в удобочитаемом формате
`-T` - вывести информацию о типе файловой системы
```

![assets/images/linux-filesystem-operations/3.png](/assets/images/linux-filesystem-operations/3.png)

<a name="#newdisk"></a>

# Как новый жесткий диск сделать доступным в системе?

<a name="fdisk"></a>

## Cоздать новый раздел

Для этого можно воспользоваться утилитами `fdisk` или `parted`. Покажу на примере первой.

```bash
# Запустить fdisk выбрав нужный диск
sudo fdisk /dev/sdb

n # создать новый раздел
p # выбрать тип, например primary
1 # ввести номер партиции или нажать enter, чтобы использовать предложенное значение
2048 # выбрать первый сектор или нажать enter, чтобы использовать предложенное значение
266338303 # выбрать последний сектор или нажать enter, чтобы использовать предложенное значение
w # записать изменения и выйти
```

<a name="mkfs"></a>

## Отформатировать раздел (создать файловую систему)

Cоздать файловую систему xfs на созданном разделе

```bash
sudo mkfs -t xfs /dev/sdb1
```

<a name="mount"></a>

## Смонтировать раздел

Добавить строку монтирования в файл /etc/fstab

```bash
sudo bash -c 'echo "/dev/sdb1 /mnt/dms xfs defaults 0 0" >> /etc/fstab '
```


### Создание раздела утилитой fdisk, файловой системы и монтирование

[![asciicast](https://asciinema.org/a/ArHlBNmnWbizJ4ujhvs0gv5mw.svg)](https://asciinema.org/a/ArHlBNmnWbizJ4ujhvs0gv5mw)


### ### Создание раздела утилитой parted, файловой системы и монтирование

[![asciicast](https://asciinema.org/a/QKFwTEIqNSxVlWVIbC8KzWM5Z.svg)](https://asciinema.org/a/QKFwTEIqNSxVlWVIbC8KzWM5Z)

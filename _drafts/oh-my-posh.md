---
layout: post
title:  "Улучшение командной строки в PowerShell, WSL и VSCode"
categories: [ Другое ]
tags: [ powershell, wsl, vscode, windows terminal ]
image: assets/images/oh-my-posh/0.jpeg
author: Mikhail
---
***Последнее время стало модным использовать продвинутую командную строку в Powershell или bash/zsh. В этой статье я расскажу, что нужно сделать в powershell, WSL, VSCode и Windows Termianl, чтобы кастомизировать командную строку и воспользоваться всеми её преимуществами.***

![assets/images/oh-my-posh/1.png](/assets/images/oh-my-posh/1.png)

Краткий план действий:

* [Установка шрифта Nerd](#Установка-шрифта-Nerd)
* [Установка и настройка Oh My Posh для PowerShell](#ps)
* [Установка и настройка Oh My Posh для WSL](#wsl)

Настройка VSCode и Windows Terminal для правильного отображения глифов

Из официально документации я мало что понял. Пришлось разбираться самому. Поэтому сейчас я я попорядку опишу путь, который пришлось пройти мне, чтобы заставить всё работать как надо. 

<a name="nerd" />

# Установка шрифта Nerd 

![assets/images/oh-my-posh/5.png](/assets/images/oh-my-posh/5.png)

На картинке выше, показаны некоторые варианты оформления (тем) командной строки. На самом деле таких тем много и вы можете их измениять и создавать свои. Как вы видите, почти все варианты содержат глифы (графические символы). Если шрифт, который используется в терминале, не содержит соответствующие глифы, в командной строке могут появиться символы замены, например квадрат - ▯ или знак вопроса �. Чтобы в терминале отображались все глифы, нужно сначала установить шрифт Nerd с сайта проекта https://www.nerdfonts.com/.

> Nerd Fonts улучшает предназначенные для разработчиков шрифты с большим количеством глифов (значков). В частности, чтобы добавить большое количество дополнительных глифов из популярных «культовых шрифтов», таких как Font Awesome, Devicons, Octicons и других.

Посмотрев несколько шрифтов, я остановил свой выбор на [Caskaydia Cove Nerd Font](https://github.com/ryanoasis/nerd-fonts/releases/download/v2.1.0/CascadiaCode.zip). 

Все шрифты можно посмотреть по ссылке https://www.nerdfonts.com/font-downloads.

Скачав нужный шрифт, нужно его установить. Заходим в архив, выбираем нужный шрифт и открываем его.

![assets/images/oh-my-posh/3.png](/assets/images/oh-my-posh/3.png)

А затем, в открывшемся окне, нажимаем кнопку Install

![assets/images/oh-my-posh/4.png](/assets/images/oh-my-posh/4.png)

Шрифт установлен, можно переходить к следующему шагу - установке Oh My Posh.

<a name="ps" />

# Установка и настройка Oh My Posh для PowerShell

Как сказано в официальной [документации](https://ohmyposh.dev/docs/), `Oh My Posh` — это настраиваемый механизм командной строки, для любой оболочки, которая имеет возможность настроить командную строку с помощью функции или переменной. Чтобы воспользоваться этим механизмом в PowerShell, нужно установить и импортировать соответствующий модуль.

Запустите PowerShell от имени администратора.
Выполните команду `Set-ExecutionPolicy RemoteSigned`

![assets/images/oh-my-posh/6.png](/assets/images/oh-my-posh/6.png)

```
Install-Module oh-my-posh -Scope CurrentUser
```

Если пакетный менеджер NuGet ещё не установлен, то PowerShell запросит разрешение на его установку. Введите `Y` и нажмите `Enter`.

Далее вас предупредят, что вы собираетесь ставить пакет из недоверенного репозитория `PSGallery`. На самом деле всё нормаль. Просто изначально все репозитории считаются недоверенными. Можете смоело продолжать установку введя `Y` и нажав `Enter`.

![assets/images/oh-my-posh/7.png](/assets/images/oh-my-posh/7.png)

Обновите профиль PowerShell, отредактировав файл `Microsoft.PowerShell_profile.ps1`. Самым простым способом открытия этого файла, явялется выполнение следующей команды.

```
notepad $PROFILE
```

Если файла не существует, то система предложет вам его создать. Нажмите Yes в диалоговом окне.

![assets/images/oh-my-posh/8.png](/assets/images/oh-my-posh/8.png)

Добавьте следующий фрагмент в конце файла. Вместо `paradox` можете написать название другой темы. Я для себя выбрал 

```
Import-Module oh-my-posh
Set-PoshPrompt -Theme jandedobbeleer
```

Теперь каждый новый экземпляр PowerShell будет запущен с импортом Oh My Posh и установкой темы командной строки.

Запустите новый экземляр PowerShell. При первом запуске вы можете увидеть процесс импорта устоановленного ранее модуля `Oh My Posh`. Он выполниться один раз. Все последующие запуски PowerShell будут проходить как обычно.

![assets/images/oh-my-posh/9.png](/assets/images/oh-my-posh/9.png)

После запуска вы увидите обновлённую командную строку, как показано на картинке ниже. Обратите внимание, что не все символы отображатся корректно. Это связано с тем, что в терминале PowerShell сейчас используется шрифт, который не поддерживает глифы.

>Как еустановить шрифт с поддержкой глифов, смотри в начале статьи.

![assets/images/oh-my-posh/10.png](/assets/images/oh-my-posh/10.png)

Зайдите в настройки терминала PowerShell и выберите шрифт с поддержкой глифов, который вы установили ранее. Или установите его сейчас, если вы пропустили этот шаг.

![assets/images/oh-my-posh/13.png](/assets/images/oh-my-posh/13.png)

![assets/images/oh-my-posh/11.png](/assets/images/oh-my-posh/11.png)

Как только вы установите правильный шрифт, вы сразу же увидите правильно отображение командной строки.

![assets/images/oh-my-posh/12.png](/assets/images/oh-my-posh/12.png)

<a name="wsl" />

# Установка и настройка Oh My Posh для WSL

> Если вы используете Windows 10 версии 2004 и выше (Build 19041 и выше) или Windows 11, и у вас ещё не установлен WSL, но вы хотите его установить, то запустите команду `wsl --install` в терминале powershell с повышенными привилегиями, а после установки WSL перезапустите Windows. Более подробные сведения об установке и настройке WSL смотрите в моей статье "Установка и настройка WSL"

Для установки oh-my-posh в Linux (WSL) нам потребуется пакетный менеджер [homebrew](https://brew.sh/). Поэтому сначала установите его, выполнив следующую команду.

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```



